---
title: "Practice, statistics"
output: 
  html_document:
    highlight: tango
    toc: true
    toc_float:
      collapsed: true
---

```{r}

library(ggpubr)
library(oddsratio)
library("performance")
library(stats)
library(ggplot2)
library(dslabs)

data("HairEyeColor")


#install.packages(c("performance", "see"))

data("mtcars")


ch <- chisq.test(x = HairEyeColor[,,1])
ch
ch <- fisher.test(x = HairEyeColor[1:2,1:2,1])
ch
 

data("ToothGrowth")
data("mtcars")
#correlation
ggplot(mtcars)+
  geom_point(aes(hp, drat))
cor.test(mtcars$hp, mtcars$drat)

#t.test/wilcox.test
ToothGrowth$supp <- as.factor(ToothGrowth$supp)
t.test(len ~ supp, data = ToothGrowth)
wilcox.test(len ~ supp, data = ToothGrowth)

p <- ggplot(ToothGrowth, aes(x = supp, y = len,
          color = supp))+
  geom_boxplot()
#  Add p-value
p + stat_compare_means()
# Change method
p + stat_compare_means(method = "t.test")

#anova and Kruskal-Wallis

summary(aov(len~dose, data = ToothGrowth))
kruskal.test(len~dose, data = ToothGrowth)

ToothGrowth$dose <- as.factor(ToothGrowth$dose)
my_comparisons <- list( c("0.5", "1"), c("1", "2"), c("0.5", "2") )
ggplot(ToothGrowth, aes(x = dose, y = len,
          color = dose))+
  geom_boxplot()+ 
  stat_compare_means(comparisons = my_comparisons, method = "t.test")+ # Add pairwise comparisons p-value
  stat_compare_means(label.y = 50, method = "anova") 


#linear regression
data("mtcars")
lm(wt~vs, data=mtcars)
res <- lm(wt~vs+am, data=mtcars)
summary(res)
plot(res)
check_model(res)

#logistic regression
data("data_glm")

fit_glm <- glm(admit ~ gre + gpa + rank, data = data_glm, family = "binomial") 

summary(fit_glm)
check_model(fit_glm)

or_glm(data = data_glm, model = fit_glm, 
       incr = list(gre = 380, gpa = 5))


```
```{r}
#install.packages("dslabs")


data(research_funding_rates)
attach(research_funding_rates)


```
1. perform chisq test by discipline
2. linear regression:
get the cleaned messy dataset
Perform linear regression en enzyme level and Age. Adjutst for gender.
Check the resulted model
3 Plot the data
4. Perform t-test on enzyme level and N stage.
plot the results.
5. Perform anova on the weight of the plants using the PlantGrowth dataset
6. Plot the results.



```{r}
#anova
data("PlantGrowth")


```





